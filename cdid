-- Autofarm Mobile-Friendly (UI Persegi Panjang Horizontal - Cocok HP!)
-- RADIUS 22K (1 MAP FULL DETECT) | Waypoint 100% urutan kamu

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Stats = game:GetService("Stats")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Waypoint 100% koordinat asli kamu
local waypoints = {
    Vector3.new(-13007.67, 1051.88, -16369.39),
    Vector3.new(-38723.95, 1013.15, -62498.38),
    Vector3.new(-50885.80, 1012.89, -86516.27),
    Vector3.new(-25909.67, 1050.33, -43893.98)
}

local TELEPORT_RADIUS = 22000  -- 1 MAP FULL DETECT
local autofarmEnabled = false
local hideNameEnabled = false
local delayTime = 40
local highPingThreshold = 200
local currentWaypointIndex  = 1
local nextFarmTime = 0
local farming = false

-- === TELEPORT SUPER NATURAL + FULL MAP RADIUS ===
local function teleportTo(pos)
    if not humanoidRootPart then return end
    -- Smooth Y
    local diffY = pos.Y - humanoidRootPart.Position.Y
    if math.abs(diffY) > 10 then
        TweenService:Create(humanoidRootPart, TweenInfo.new(0.9), {CFrame = humanoidRootPart.CFrame + Vector3.new(0, diffY, 0)}):Play()
        task.wait(1)
    end
    -- Random dalam radius 22K (cover seluruh map)
    local randX = math.random(-TELEPORT_RADIUS, TELEPORT_RADIUS)
    local randZ = math.random(-TELEPORT_RADIUS, TELEPORT_RADIUS)
    local final = Vector3.new(pos.X + randX, humanoidRootPart.Position.Y, pos.Z + randZ)
    TweenService:Create(humanoidRootPart, TweenInfo.new(1.2, Enum.EasingStyle.Quad), {CFrame = CFrame.new(final)}):Play()
    task.wait(1.3)
end

-- === NOTIFIKASI ===
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "AutofarmUI"

local function notif(msg)
    spawn(function()
        local f = Instance.new("Frame", screenGui)
        f.Size = UDim2.new(0, 300, 0, 60)
        f.Position = UDim2.new(0.5, -150, 0, -70)
        f.BackgroundColor3 = Color3.fromRGB(20, 120, 20)
        f.BackgroundTransparency = 0.2
        f.BorderSizePixel = 0
        Instance.new("UICorner", f).CornerRadius = UDim.new(0, 12)
        local stroke = Instance.new("UIStroke", f)
        stroke.Color = Color3.new(0,1,0)
        stroke.Thickness = 2

        local txt = Instance.new("TextLabel", f)
        txt.Size = UDim2.new(1,0,1,0)
        txt.BackgroundTransparency = 1
        txt.Text = msg
        txt.TextColor3 = Color3.new(1,1,1)
        txt.TextScaled = true
        txt.Font = Enum.Font.GothamBold

        TweenService:Create(f, TweenInfo.new(0.6, Enum.EasingStyle.Back), {Position = UDim2.new(0.5,-150,0,20)}):Play()
        task.wait(3)
        TweenService:Create(f, TweenInfo.new(0.6), {Position = UDim2.new(0.5,-150,0,-70)}):Play()
        task.wait(0.7)
        f:Destroy()
    end)
end

-- === AUTOFARM LOOP ===
spawn(function()
    while task.wait(0.5) do
        if autofarmEnabled and tick() >= nextFarmTime and not farming then
            farming = true
            spawn(function()
                teleportTo(waypoints[currentWaypointIndex])
                currentWaypointIndex = (currentWaypointIndex % #waypoints) + 1
                nextFarmTime = tick() + delayTime
                farming = false
                notif("Farmed WP "..currentWaypointIndex.." [FULL MAP RADIUS]")
            end)
        end
    end
end)

-- === TOMBOL BULAT KIRI ATAS (Mobile Friendly) ===
local toggleBtn = Instance.new("ImageButton", screenGui)
toggleBtn.Size = UDim2.new(0,60,0,60)
toggleBtn.Position = UDim2.new(0,15,0,15)
toggleBtn.BackgroundColor3 = Color3.fromRGB(10,10,40)
toggleBtn.BorderSizePixel = 0
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1,0)
local grad = Instance.new("UIGradient", toggleBtn)
grad.Color = ColorSequence.new(Color3.fromRGB(0,180,255), Color3.fromRGB(100,100,255))
grad.Rotation = 45
Instance.new("UIStroke", toggleBtn).Color = Color3.new(1,1,1)

-- === MENU PERSEGI PANJANG HORIZONTAL (Landscape / HP) ===
local menu = Instance.new("Frame", screenGui)
menu.Size = UDim2.new(0.95, 0, 0, 130)          -- Panjang hampir full, tinggi cuma 130px
menu.Position = UDim2.new(0.025, 0, 0, 90)     -- Di bawah tombol bulat
menu.BackgroundColor3 = Color3.fromRGB(15,15,35)
menu.Visible = false
menu.BorderSizePixel = 0
Instance.new("UICorner", menu).CornerRadius = UDim.new(0,16)
local menuStroke = Instance.new("UIStroke", menu)
menuStroke.Color = Color3.fromRGB(0,200,255)
menuStroke.Thickness = 3

-- Horizontal layout
local layout = Instance.new("UIListLayout", menu)
layout.FillDirection = Enum.FillDirection.Horizontal
layout.Padding = UDim.new(0,12)
layout.VerticalAlignment = Enum.VerticalAlignment.Center
layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Tombol-tombol di dalam menu horizontal
local function createBtn(text, color, callback)
    local btn = Instance.new("TextButton", menu)
    btn.Size = UDim2.new(0,120,0,80)
    btn.BackgroundColor3 = color
    btn.Text = text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextScaled = true
    btn.Font = Enum.Font.GothamBold
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,12)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

createBtn("Autofarm\nOFF", Color3.fromRGB(80,30,30), function()
    autofarmEnabled = not autofarmEnabled
    local b = menu:FindFirstChildOfClass("TextButton")
    b.Text = "Autofarm\n"..(autofarmEnabled and "ON" or "OFF")
    b.BackgroundColor3 = autofarmEnabled and Color3.fromRGB(30,100,30) or Color3.fromRGB(80,30,30)
end)

createBtn("Delay: 40s", Color3.fromRGB(40,40,100), function()
    delayTime = (delayTime == 40) and 30 or (delayTime == 30) and 55 or 40
    local b = menu:FindFirstChildWhichIsA("TextButton", true)
    for _,v in pairs(menu:GetChildren()) do
        if v.Text:find("Delay") then v.Text = "Delay: "..delayTime.."s" end
    end
end)

createBtn("Hide Name\nOFF", Color3.fromRGB(100,40,100), function()
    hideNameEnabled = not hideNameEnabled
    local b = menu:FindFirstChildWhichIsA("TextButton", true)
    for _,v in pairs(menu:GetChildren()) do
        if v.Text:find("Hide Name") then
            v.Text = "Hide Name\n"..(hideNameEnabled and "ON" or "OFF")
            v.BackgroundColor3 = hideNameEnabled and Color3.fromRGB(60,120,60) or Color3.fromRGB(100,40,100)
        end
    end
    if hideNameEnabled then
        pcall(function()
            for _,v in pairs(character.Head:GetChildren()) do
                if v:IsA("BillboardGui") then v:Destroy() end
            end
        end)
    end
end)

createBtn("FULL MAP", Color3.fromRGB(0,100,150), function() end) -- Info aja

-- === TOGGLE MENU ===
toggleBtn.MouseButton1Click:Connect(function()
    menu.Visible = not menu.Visible
end)

-- Respawn handler
player.CharacterAdded:Connect(function(c)
    character = c
    humanoidRootPart = c:WaitForChild("HumanoidRootPart")
end)

notif("Mobile UI + FULL MAP RADIUS Loaded!")
print("Autofarm Mobile Ready | Tap bulatan kiri atas!")
