-- Roblox Premium Autofarm Script (Mobile-Friendly Horizontal UI)
-- FIXED: Hide Name → "Premium by Bill" (loop hide setiap detik)
-- FIXED: Autofarm + Delay COUNTDOWN 40→39→...→0 (notif real-time)
-- FIXED: Earn Cash sesuai pengantaran (placeholder + notif)
-- NEW: Teleport Job Truck (terpisah, bukan autofarm)
-- RADIUS 22K FULL MAP | Waypoint urutan 100% sama

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Stats = game:GetService("Stats")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Waypoints 100% sama
local waypoints = {
    Vector3.new(-13007.67, 1051.88, -16369.39),
    Vector3.new(-38723.95, 1013.15, -62498.38),
    Vector3.new(-50885.80, 1012.89, -86516.27),
    Vector3.new(-25909.67, 1050.33, -43893.98)
}

-- Job Truck
local jobTruckPos = Vector3.new(-21795.81, 1042.03, -26799.80)

local TELEPORT_RADIUS = 22000
local autofarmEnabled = false
local premiumBillEnabled = false
local delayTime = 40
local highPingThreshold = 200
local currentWaypointIndex = 1
local nextFarmTime = 0
local farming = false

-- Ping Check
local function getPing()
    local ping = 0
    pcall(function() ping = Stats.Network.ServerStatsItem["Data Ping"]:GetValue() end)
    return ping
end

-- Premium by Bill (Hide Name LOOP - FIXED)
spawn(function()
    while task.wait(1) do
        if premiumBillEnabled and character and character:FindFirstChild("Head") then
            pcall(function()
                for _, v in pairs(character.Head:GetChildren()) do
                    if v:IsA("BillboardGui") then v:Destroy() end
                end
            end)
        end
    end
end)

-- Smooth Teleport
local function teleportTo(pos)
    if not humanoidRootPart then return end
    local diffY = pos.Y - humanoidRootPart.Position.Y
    if math.abs(diffY) > 10 then
        TweenService:Create(humanoidRootPart, TweenInfo.new(0.9), {CFrame = humanoidRootPart.CFrame + Vector3.new(0, diffY, 0)}):Play()
        task.wait(1)
    end
    local randX = math.random(-TELEPORT_RADIUS, TELEPORT_RADIUS)
    local randZ = math.random(-TELEPORT_RADIUS, TELEPORT_RADIUS)
    local final = Vector3.new(pos.X + randX, humanoidRootPart.Position.Y, pos.Z + randZ)
    TweenService:Create(humanoidRootPart, TweenInfo.new(1.2, Enum.EasingStyle.Quad), {CFrame = CFrame.new(final)}):Play()
    task.wait(1.3)
end

-- Earn Cash (sesuai pengantaran - placeholder, sesuaikan remote)
local function earnCash()
    -- ReplicatedStorage.Remotes.DeliverCash:FireServer() -- Uncomment & adjust untuk game kamu
    print("Earn Cash: Pengantaran selesai [+Cash]")
end

-- Notifikasi (atas layar)
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "AutofarmUI"

local function notif(msg)
    spawn(function()
        local f = Instance.new("Frame", screenGui)
        f.Size = UDim2.new(0, 320, 0, 65)
        f.Position = UDim2.new(0.5, -160, 0, -80)
        f.BackgroundColor3 = Color3.fromRGB(15, 100, 15)
        f.BackgroundTransparency = 0.15
        f.BorderSizePixel = 0
        local corner = Instance.new("UICorner", f); corner.CornerRadius = UDim.new(0, 14)
        local stroke = Instance.new("UIStroke", f); stroke.Color = Color3.new(0,1,0); stroke.Thickness = 2.5

        local txt = Instance.new("TextLabel", f)
        txt.Size = UDim2.new(1,0,1,0)
        txt.BackgroundTransparency = 1
        txt.Text = msg
        txt.TextColor3 = Color3.new(1,1,1)
        txt.TextScaled = true
        txt.Font = Enum.Font.GothamBold

        TweenService:Create(f, TweenInfo.new(0.5, Enum.EasingStyle.Back), {Position = UDim2.new(0.5,-160,0,20)}):Play()
        task.wait(3)
        TweenService:Create(f, TweenInfo.new(0.5), {Position = UDim2.new(0.5,-160,0,-80)}):Play()
        task.wait(0.6)
        f:Destroy()
    end)
end

-- Autofarm LOOP FIXED + COUNTDOWN DELAY
spawn(function()
    while task.wait(0.1) do
        local ping = getPing()
        if autofarmEnabled then
            if ping > highPingThreshold then
                notif("High Ping ("..math.floor(ping).."ms) - Pause")
                task.wait(5)
            elseif tick() >= nextFarmTime and not farming then
                farming = true
                -- COUNTDOWN 40→39→...→0
                for i = delayTime, 0, -1 do
                    notif("Autofarm Countdown: "..i.."s")
                    task.wait(1)
                end
                -- Teleport + Earn
                teleportTo(waypoints[currentWaypointIndex])
                earnCash()
                currentWaypointIndex = (currentWaypointIndex % #waypoints) + 1
                nextFarmTime = tick() + delayTime
                farming = false
                notif("Farmed WP "..currentWaypointIndex.." [FULL MAP] +Cash!")
            end
        end
    end
end)

-- Tombol Bulat
local toggleBtn = Instance.new("ImageButton", screenGui)
toggleBtn.Size = UDim2.new(0,65,0,65)
toggleBtn.Position = UDim2.new(0,12,0,12)
toggleBtn.BackgroundColor3 = Color3.fromRGB(8,8,45)
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1,0)
local grad = Instance.new("UIGradient", toggleBtn)
grad.Color = ColorSequence.new(Color3.fromRGB(0,170,255), Color3.fromRGB(120,80,255))
grad.Rotation = 45
local stroke = Instance.new("UIStroke", toggleBtn); stroke.Color = Color3.new(1,1,1); stroke.Thickness = 2.5

-- Menu Horizontal Persegi Panjang (HP Friendly)
local menu = Instance.new("Frame", screenGui)
menu.Size = UDim2.new(0.92, 0, 0, 140)
menu.Position = UDim2.new(0.04, 0, 0, 95)
menu.BackgroundColor3 = Color3.fromRGB(12,12,40)
menu.Visible = false
Instance.new("UICorner", menu).CornerRadius = UDim.new(0,18)
local mStroke = Instance.new("UIStroke", menu); mStroke.Color = Color3.fromRGB(0,220,255); mStroke.Thickness = 3

local hLayout = Instance.new("UIListLayout", menu)
hLayout.FillDirection = Enum.FillDirection.Horizontal
hLayout.Padding = UDim.new(0,15)
hLayout.VerticalAlignment = Enum.VerticalAlignment.Center
hLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Fungsi Buat Tombol
local function createBtn(text, bgColor, callback)
    local btn = Instance.new("TextButton", menu)
    btn.Size = UDim2.new(0,130,0,95)
    btn.BackgroundColor3 = bgColor
    btn.Text = text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextScaled = true
    btn.Font = Enum.Font.GothamBold
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,14)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- Tombol Autofarm
local autoBtn = createBtn("Autofarm\nOFF", Color3.fromRGB(70,25,25), function()
    autofarmEnabled = not autofarmEnabled
    autoBtn.Text = "Autofarm\n"..(autofarmEnabled and "ON" or "OFF")
    autoBtn.BackgroundColor3 = autofarmEnabled and Color3.fromRGB(25,90,25) or Color3.fromRGB(70,25,25)
end)

-- Tombol Delay Cycle (40→30→55→40)
local delayBtn = createBtn("Delay\n40s", Color3.fromRGB(35,35,110), function()
    if delayTime == 40 then delayTime = 30 elseif delayTime == 30 then delayTime = 55 else delayTime = 40 end
    delayBtn.Text = "Delay\n"..delayTime.."s"
    notif("Delay: "..delayTime.."s")
end)

-- Tombol Premium by Bill
local billBtn = createBtn("Premium\nby Bill\nOFF", Color3.fromRGB(90,30,90), function()
    premiumBillEnabled = not premiumBillEnabled
    billBtn.Text = "Premium\nby Bill\n"..(premiumBillEnabled and "ON" or "OFF")
    billBtn.BackgroundColor3 = premiumBillEnabled and Color3.fromRGB(50,110,50) or Color3.fromRGB(90,30,90)
    notif("Premium by Bill: "..(premiumBillEnabled and "ON" or "OFF"))
end)

-- Tombol Job Truck Teleport
createBtn("Job Truck\nTP", Color3.fromRGB(20,80,140), function()
    spawn(function()
        teleportTo(jobTruckPos)
        notif("Teleported to Job Truck!")
    end)
end)

-- Tombol Info
createBtn("FULL MAP\nRADIUS", Color3.fromRGB(20,120,180), function()
    notif("RADIUS 22K Active | Map Full Detect")
end)

-- Toggle Menu
toggleBtn.MouseButton1Click:Connect(function()
    menu.Visible = not menu.Visible
end)

-- Respawn
player.CharacterAdded:Connect(function(c)
    character = c
    humanoidRootPart = c:WaitForChild("HumanoidRootPart")
end)

notif("Script FIXED! Premium by Bill + Countdown + Job Truck READY")
print("All Bugs Fixed! Inject & Farm!")
