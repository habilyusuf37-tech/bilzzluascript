-- Premium Hub (Orion Version - Key: premiumhub)
if not game:IsLoaded() then game.Loaded:Wait() end

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Orion Library (selalu hidup 2025)
local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()

local function getRemote(name,class,timeout)
    local ok,obj=pcall(function()return ReplicatedStorage:WaitForChild(name,timeout or 5)end)
    return (ok and obj and obj.ClassName==class) and obj or nil
end

local TeleportDealerEvent = getRemote("TeleportDealerEvent","RemoteEvent")
local OpenDealerEvent     = getRemote("OpenDealerEvent","RemoteEvent")
local OpenDealerClient    = getRemote("OpenDealerClient","RemoteEvent")
local GetDealerItems      = getRemote("GetDealerItems","RemoteFunction")
local BuyCarEvent         = getRemote("BuyCarEvent","RemoteEvent")
local ClaimBoxEvent       = getRemote("ClaimBoxEvent","RemoteEvent")
local NotifyEvent         = getRemote("NotifyEvent","RemoteEvent")

local function safeFire(r,...) if r then pcall(function() r:FireServer(...) end) end end
local function safeInvoke(r,...) if r then local s,v=pcall(r.InvokeServer,r,...) return s and v end end

local DealerTP = {
    Vector3.new(351.16,8.19,-286.64),
    Vector3.new(940.53,6.29,-474.83),
    Vector3.new(2470.92,5.11,-550.10),
    Vector3.new(3083.91,5.55,-546.16),
}

-- Dealer UI (tetap sama)
local function dealerUI()
    local s=Instance.new("ScreenGui",PlayerGui) s.Name="DealerUI" s.ResetOnSpawn=false
    local f=Instance.new("Frame",s) f.Name="MainFrame" f.AnchorPoint=Vector2.new(.5,.5) f.Position=UDim2.new(.5,0,.5,0)
    f.Size=UDim2.new(0,720,0,420) f.BackgroundTransparency=.15 f.BackgroundColor3=Color3.fromRGB(30,30,30)

    local t=Instance.new("TextLabel",f) t.Name="Title" t.Size=UDim2.new(1,0,0,40)
    t.BackgroundTransparency=1 t.Font=Enum.Font.SourceSansBold t.TextSize=22 t.TextColor3=Color3.new(1,1,1) t.Text="Dealer"

    local list=Instance.new("ScrollingFrame",f) list.Name="List"
    list.Size=UDim2.new(1,-20,1,-60) list.Position=UDim2.new(0,10,0,45)
    list.AutomaticCanvasSize=Enum.AutomaticSize.Y list.ScrollBarThickness=8

    local template=Instance.new("Frame",list) template.Name="TemplateItem"
    template.Size=UDim2.new(1,-10,0,80) template.Visible=false template.BackgroundTransparency=.25

    Instance.new("TextLabel",template).Name="CarName"
    Instance.new("TextLabel",template).Name="Price"
    local b=Instance.new("TextButton",template) b.Name="BuyButton" b.Size=UDim2.new(.12,-10,.8,-10) b.Position=UDim2.new(.86,0,.1,0) b.Text="Buy"
    return s
end

local GUI

-- Notify dari server (pake Orion notification)
if NotifyEvent then
    NotifyEvent.OnClientEvent:Connect(function(t,m)
        OrionLib:MakeNotification({Name=tostring(t),Content=tostring(m),Duration=4})
    end)
end

-- Dealer UI dari server
if OpenDealerClient then
    OpenDealerClient.OnClientEvent:Connect(function(name)
        GUI = GUI or dealerUI()
        GUI.Enabled=true
        local frame = GUI.MainFrame
        frame.Title.Text = name.." Dealer"

        for _,v in ipairs(frame.List:GetChildren()) do if v:IsA("Frame") and v.Name~="TemplateItem" then v:Destroy() end end
        local items = safeInvoke(GetDealerItems,name)
        local temp = frame.List.TemplateItem

        for i,v in ipairs(items or {}) do
            local c=temp:Clone() c.Visible=true c.Name="Item"..i c.Parent=frame.List
            c.CarName.Text=v.Name c.Price.Text="$"..v.Price
            c.BuyButton.MouseButton1Click:Connect(function() safeFire(BuyCarEvent,name,v.Id) end)
        end
    end)
end

-- ==== KEY SYSTEM ORION (key: premiumhub) ====
OrionLib:InitKeySystem({
    Title = "Premium Hub",
    Description = "Masukkan key: premiumhub",
    Key = "premiumhub",
    SaveKey = true,
    Callback = function()
        OrionLib:MakeNotification({Name = "Success!", Content = "Premium Hub Loaded", Duration = 6})

        local Window = OrionLib:MakeWindow({Name = "PremiumHub", HidePremium = false, SaveConfig = true, ConfigFolder = "PremiumHub"})

        local dealer,tele,af,tpTime = "Premium",1,false,3
        local webhook = ""

        local Main = Window:MakeTab({Name = "Main"})
        Main:AddTextbox({Name = "Webhook", Text = "", Callback = function(t) webhook = t end})
        Main:AddToggle({Name = "AutoFarm", CurrentValue = false, Callback = function(v) af = v end})
        Main:AddButton({Name = "Stop Farm", Callback = function() af = false end})

        local Stats = Window:MakeTab({Name = "Stats"})
        Stats:AddParagraph("Status","Idle")
        Stats:AddParagraph("Money","$0")

        local Config = Window:MakeTab({Name = "Config"})
        Config:AddSlider({Name = "TP Time", Min = 1, Max = 30, Default = 3, Increment = 1, Callback = function(v) tpTime = v end})

        local Box = Window:MakeTab({Name = "Box"})
        Box:AddButton({Name = "Daily Box", Callback = function() safeFire(ClaimBoxEvent,"Daily") end})
        Box:AddButton({Name = "Limited Box", Callback = function() safeFire(ClaimBoxEvent,"Limited") end})
        Box:AddButton({Name = "Gamepass Box", Callback = function() safeFire(ClaimBoxEvent,"Gamepass") end})

        local D = Window:MakeTab({Name = "Dealership"})
        D:AddDropdown({Name = "Brand", Options = {"Premium","SLM","Toyota","BMR","Nissan","Retro","Mizada","Hyundai"}, Default = "Premium", Callback = function(v) dealer = v end})
        D:AddDropdown({Name = "Dealer", Options = {"Dealer 1","Dealer 2","Dealer 3","Dealer 4"}, Default = "Dealer 1", Callback = function(v) tele = tonumber(v:match("%d+")) end})
        D:AddButton({Name = "TP Dealer", Callback = function()
            if TeleportDealerEvent then 
                safeFire(TeleportDealerEvent,tele)
            else
                local c = LocalPlayer.Character
                if c and c:FindFirstChild("HumanoidRootPart") then
                    c:PivotTo(CFrame.new(DealerTP[tele]))
                end
            end
        end})
        D:AddButton({Name = "Open Dealer", Callback = function() safeFire(OpenDealerEvent,dealer) end})
        D:AddButton({Name = "Buy Car (UI)", Callback = function()
            OrionLib:MakeNotification({Name = "Info", Content = "Buka dealer dulu lalu klik tombol Buy di UI dealer", Duration = 6})
        end})
    end
})
