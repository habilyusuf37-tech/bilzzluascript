-- // PREMIUM AUTOFARM BY MIYOSHI \\ --
-- Key System
local Key = "MIYOSHI2025"  -- Ganti kalau mau
local CorrectKey = false

local function CheckKey()
    local input = readfile and readfile("MiyoshiKey.txt") or ""
    if input == Key then
        CorrectKey = true
    else
        repeat
            local keyinput = game:GetService("UserInputService").InputBegan:Wait()
            if keyinput.KeyCode == Enum.KeyCode.Insert then
                local gui = Instance.new("ScreenGui", game.CoreGui)
                local frame = Instance.new("Frame", gui)
                frame.Size = UDim2.new(0, 300, 0, 150)
                frame.Position = UDim2.new(0.5, -150, 0.5, -75)
                frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
                frame.BorderSizePixel = 0
                
                local text = Instance.new("TextBox", frame)
                text.Size = UDim2.new(1, -20, 0, 50)
                text.Position = UDim2.new(0, 10, 0, 20)
                text.PlaceholderText = "Masukkan Key PREMIUM BY MIYOSHI"
                text.Text = ""
                text.BackgroundColor3 = Color3.fromRGB(40,40,40)
                text.TextColor3 = Color3.new(1,1,1)
                
                text.FocusLost:Connect(function(enter)
                    if enter and text.Text == Key then
                        CorrectKey = true
                        gui:Destroy()
                        if writefile then writefile("MiyoshiKey.txt", Key) end
                        game.StarterGui:SetCore("SendNotification", {Title = "Premium Activated"; Text = "BY MIYOSHI"; Duration = 5})
                    end
                end)
            end
            wait(0.1)
        until CorrectKey
    end
end

CheckKey()

if not CorrectKey then return end

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- Variables
local AutoFarmEnabled = false
local WalkSpeedEnabled = false
local ESPEnabled = false
local HideNameEnabled = false
local DelayTime = 6

local Coordinates = {
    Vector3.new(2879, 4, -863),
    Vector3.new(-5, 4, 25),
    Vector3.new(3141, 5, -111)
}

local CurrentIndex = 1
local DeliveryCount = 0
local TotalCash = 0
local TotalCoins = 0

-- Premium UI (Bisa di-drag, hide/show, scrollable)
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "MiyoshiPremium"

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 380, 0, 500)
MainFrame.Position = UDim2.new(0, 50, 0.5, -250)
MainFrame.BackgroundColor3 = Color3.fromRGB(15,15,15)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = true
MainFrame.Active = true
MainFrame.Draggable = true

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1,0,0,40)
Title.BackgroundColor3 = Color3.fromRGB(255, 0, 100)
Title.Text = "PREMIUM BY MIYOSHI"
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18

local HideButton = Instance.new("TextButton", MainFrame)
HideButton.Size = UDim2.new(0, 40, 0, 40)
HideButton.Position = UDim2.new(1, -45, 0, 5)
HideButton.BackgroundColor3 = Color3.new(1,1,1)
HideButton.Text = "B"
HideButton.TextColor3 = Color3.new(0,0,0)
HideButton.Font = Enum.Font.GothamBold
HideButton.TextSize = 20
HideButton.TextScaled = true

local ScrollingFrame = Instance.new("ScrollingFrame", MainFrame)
ScrollingFrame.Size = UDim2.new(1, -10, 1, -50)
ScrollingFrame.Position = UDim2.new(0, 5, 0, 45)
ScrollingFrame.BackgroundTransparency = 1
ScrollingFrame.ScrollBarThickness = 8

-- Toggle Functions
local function CreateButton(name, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 50)
    btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Text = name
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 18
    btn.Parent = ScrollingFrame
    
    btn.MouseButton1Click:Connect(function()
        callback()
        btn.BackgroundColor3 = btn.BackgroundColor3:Lerp(Color3.new(1,1,1), 0.3)
        wait(0.1)
        btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    end)
end

-- Hide/Show UI
HideButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- Features
CreateButton("Toggle AutoFarm", function()
    AutoFarmEnabled = not AutoFarmEnabled
    game.StarterGui:SetCore("SendNotification", {Title="AutoFarm", Text= AutoFarmEnabled and "ON" or "OFF"})
end)

CreateButton("Toggle ESP", function()
    ESPEnabled = not ESPEnabled
    if ESPEnabled then LoadESP() end
end)

CreateButton("Toggle WalkSpeed (150)", function()
    WalkSpeedEnabled = not WalkSpeedEnabled
    LocalPlayer.Character.Humanoid.WalkSpeed = WalkSpeedEnabled and 150 or 16
end)

CreateButton("Premium Hide Name", function()
    HideNameEnabled = not HideNameEnabled
    if HideNameEnabled and LocalPlayer.Character then
        for _,v in pairs(LocalPlayer.Character:GetChildren()) do
            if v:IsA("BillboardGui") or v.Name == "OriginalName" then v:Destroy() end
        end
        if LocalPlayer.Character:FindFirstChild("Head") then
            local name = LocalPlayer.Character.Head:FindFirstChildWhichIsA("BillboardGui")
            if name then name:Destroy() end
        end
    end
end)

-- ESP Simple
function LoadESP()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local esp = Instance.new("Highlight", player.Character)
            esp.FillColor = Color3.fromRGB(255,0,0)
            esp.OutlineColor = Color3.new(1,1,1)
            esp.FillTransparency = 0.5
        end
    end
    Players.PlayerAdded:Connect(function(plr)
        plr.CharacterAdded:Wait():WaitForChild("Head")
        local hl = Instance.new("Highlight", plr.Character)
        hl.FillColor = Color3.fromRGB(255,0,0)
    end)
end

-- Waypoint Detection (contoh: cari part bernama "DeliveryPoint" atau "Waypoint")
local function FindWaypoint()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name:lower():find("delivery") or obj.Name:lower():find("waypoint") or obj.Name:lower():find("drop") then
            if obj:IsA("BasePart") or obj:IsA("Model") and obj:FindFirstChildWhichIsA("BasePart") then
                return obj.Position or obj.PrimaryPart.Position
            end
        end
    end
    return nil
end

-- AutoFarm Loop
spawn(function()
    while wait(0.5) do
        if AutoFarmEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = LocalPlayer.Character.HumanoidRootPart
            
            local target
            if DeliveryCount >= 7 then
                target = FindWaypoint()
            end
            
            if not target then
                target = Coordinates[CurrentIndex]
            end
            
            hrp.CFrame = CFrame.new(target + Vector3.new(0, 5, 0))
            wait(0.3)
            
            -- Hold E 5 detik
            if game:GetService("VirtualInputManager") then
                game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.E, false, game)
                wait(5)
                game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.E, false, game)
            end
            
            wait(DelayTime)
            
            DeliveryCount = DeliveryCount + 1
            TotalCash = TotalCash + 15000
            TotalCoins = TotalCoins + 20
            
            game.StarterGui:SetCore("SendNotification", {
                Title = "Delivery #"..DeliveryCount;
                Text = "+15.000 Cash | +20 Coins\nTotal: "..TotalCash.." Cash";
                Duration = 4
            })
            
            CurrentIndex = CurrentIndex + 1
            if CurrentIndex > #Coordinates then CurrentIndex = 1 end
        end
    end
end)

-- Final UI Setup
local function UpdateCanvas()
    ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, #ScrollingFrame:GetChildren() * 55)
end
UpdateCanvas()

game.StarterGui:SetCore("SendNotification", {
    Title = "PREMIUM BY MIYOSHI";
    Text = "Script berhasil di-inject! Enjoy premium features.";
    Duration = 8;
})

print("PREMIUM BY MIYOSHI - Fully Loaded")
