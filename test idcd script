-- MIYOSHI BLACK PREMIUM v11 - PROFIT/MIN + DELAY SETTABLE + PREMIUM TAG

local Players = game:GetService("Players")
local VirtualInputManager = game:GetService("VirtualInputManager")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local camera = workspace.CurrentCamera

-- Manual Locations (backup)
local ManualLocations = {
    Vector3.new(2879, 4, -863),
    Vector3.new(-5, 4, 25),
    Vector3.new(3141, 5, -111)
}

local autofarm = false
local flying = false
local noclip = false
local espEnabled = false
local customDelay = 6        -- default delay (bisa diubah di UI)
local lastMoney = 0
local profitPerMinute = 0

-- Hitung profit per menit
spawn(function()
    lastMoney = getMoney()
    while task.wait(10) do
        local current = getMoney()
        local earned = current - lastMoney
        profitPerMinute = earned * 6  -- 10 detik â†’ x6 = per menit
        lastMoney = current
    end
end)

-- GET MONEY
function getMoney()
    if player:FindFirstChild("leaderstats") then
        for _, v in player.leaderstats:GetChildren() do
            if v:IsA("ValueBase") and (string.find(v.Name:lower(), "money") or string.find(v.Name:lower(), "cash") or string.find(v.Name:lower(), "coin")) then
                return v.Value
            end
        end
    end
    return 0
end

-- WAYPOINT TERDEKAT
local function getNearestWaypoint()
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nil end
    local closest = nil
    local distBest = math.huge
    for _, obj in workspace:GetDescendants() do
        if obj:IsA("BasePart") or obj:IsA("Model") then
            local n = obj.Name:lower()
            if n:find("way") or n:find("mark") or n:find("point") or n:find("target") or n:find("path") then
                local pos = obj:IsA("BasePart") and obj.Position or (obj:FindFirstChildWhichIsA("BasePart") and obj:FindFirstChildWhichIsA("BasePart").Position)
                if pos then
                    local dist = (hrp.Position - pos).Magnitude
                    if dist < distBest then
                        distBest = dist
                        closest = pos + Vector3.new(0,5,0)
                    end
                end
            end
        end
    end
    return closest
end

-- NAMA "hide name by miyoshi"
local function setMiyoshiName()
    if character and character:FindFirstChild("Head") then
        for _, v in character.Head:GetChildren() do
            if v:IsA("BillboardGui") then
                for _, lbl in v:GetDescendants() do
                    if lbl:IsA("TextLabel") then
                        lbl.Text = "hide name by miyoshi"
                        lbl.TextColor3 = Color3.new(1,1,1)
                        lbl.TextStrokeTransparency = 0
                        lbl.TextStrokeColor3 = Color3.new(0,0,0)
                        lbl.Font = Enum.Font.GothamBold
                        lbl.TextSize = 20
                    end
                end
            end
        end
    end
end
player.CharacterAdded:Connect(function(c) character = c task.wait(2) setMiyoshiName() end)

-- FLY, NOCLIP, ESP (sama seperti sebelumnya)
-- ... (kode fly, noclip, esp tetap sama, aku skip biar tidak kepanjangan)

-- HOLD E 5 DETIK
local function holdE5()
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
    task.wait(5)
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
end

-- TELEPORT
local function tp(pos)
    local root = character:FindFirstChild("HumanoidRootPart")
    if root then root.CFrame = CFrame.new(pos) end
end

-- AUTOFARM (pakai custom delay)
local function startAutoFarm()
    if autofarm then return end
    autofarm = true
    task.spawn(function()
        local manualIdx = 1
        while autofarm and character and character:FindFirstChild("HumanoidRootPart") do
            local wp = getNearestWaypoint()
            if wp then
                tp(wp)
            else
                tp(ManualLocations[manualIdx])
                manualIdx = (manualIdx % #ManualLocations) + 1
            end
            task.wait(0.8)
            holdE5()
            task.wait(customDelay)  -- PAKAI DELAY YANG DIATUR DI UI
        end
    end)
end
local function stopAutoFarm() autofarm = false end

--------------------------------------------------
-- UI BLACK PREMIUM + PROFIT + DELAY SETTER
--------------------------------------------------

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MiyoshiPremium"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

-- Floating B
local OpenBtn = Instance.new("TextButton")
OpenBtn.Size = UDim2.new(0,60,0,60)
OpenBtn.Position = UDim2.new(1,-80,1,-80)
OpenBtn.BackgroundColor3 = Color3.new(1,1,1)
OpenBtn.Text = "B"
OpenBtn.TextSize = 36
OpenBtn.Font = Enum.Font.GothamBlack
OpenBtn.Visible = false
OpenBtn.Parent = ScreenGui
Instance.new("UICorner", OpenBtn).CornerRadius = UDim.new(1,0)

-- Main Frame
local Main = Instance.new("Frame")
Main.Size = UDim2.new(0,420,0,440)
Main.Position = UDim2.new(0.5,-210,0.5,-220)
Main.BackgroundColor3 = Color3.fromRGB(10,10,10)
Main.Parent = ScreenGui
Instance.new("UICorner", Main).CornerRadius = UDim.new(0,16)
local stroke = Instance.new("UIStroke", Main)
stroke.Color = Color3.fromRGB(255,215,0)  -- GOLD untuk PREMIUM
stroke.Thickness = 4

-- PREMIUM TAG
local PremiumTag = Instance.new("TextLabel")
PremiumTag.Size = UDim2.new(1,0,0,50)
PremiumTag.BackgroundTransparency = 1
PremiumTag.Text = "PREMIUM"
PremiumTag.TextColor3 = Color3.fromRGB(255,215,0)
PremiumTag.TextStrokeTransparency = 0
PremiumTag.TextStrokeColor3 = Color3.new(0,0,0)
PremiumTag.TextSize = 40
PremiumTag.Font = Enum.Font.GothamBlack
PremiumTag.Parent = Main

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1,0,0,40)
Title.Position = UDim2.new(0,0,0,45)
Title.BackgroundTransparency = 1
Title.Text = "MIYOSHI BLACK HUB"
Title.TextColor3 = Color3.new(1,1,1)
Title.TextSize = 28
Title.Font = Enum.Font.GothamBold
Title.Parent = Main

-- Money + Profit
local MoneyLabel = Instance.new("TextLabel")
MoneyLabel.Size = UDim2.new(1,-20,0,40)
MoneyLabel.Position = UDim2.new(0,10,0,90)
MoneyLabel.BackgroundColor3 = Color3.fromRGB(30,30,30)
MoneyLabel.TextColor3 = Color3.fromRGB(0,255,100)
MoneyLabel.Text = "Money: Loading..."
MoneyLabel.TextSize = 22
MoneyLabel.Font = Enum.Font.GothamBold
MoneyLabel.Parent = Main
Instance.new("UICorner", MoneyLabel).CornerRadius = UDim.new(0,10)

local ProfitLabel = Instance.new("TextLabel")
ProfitLabel.Size = UDim2.new(1,-20,0,35)
ProfitLabel.Position = UDim2.new(0,10,0,135)
ProfitLabel.BackgroundColor3 = Color3.fromRGB(40,40,0)
ProfitLabel.TextColor3 = Color3.fromRGB(255,255,0)
ProfitLabel.Text = "Profit/min: Calculating..."
ProfitLabel.TextSize = 20
ProfitLabel.Parent = Main
Instance.new("UICorner", ProfitLabel).CornerRadius = UDim.new(0,8)

-- Delay Setter
local DelayBox = Instance.new("TextBox")
DelayBox.Size = UDim2.new(0,360,0,45)
DelayBox.Position = UDim2.new(0.5,-180,0,180)
DelayBox.BackgroundColor3 = Color3.fromRGB(50,0,50)
DelayBox.Text = "Delay: "..customDelay.."s"
DelayBox.TextColor3 = Color3.new(1,1,1)
DelayBox.TextSize = 22
DelayBox.Parent = Main
Instance.new("UICorner", DelayBox).CornerRadius = UDim.new(0,10)

DelayBox.FocusLost:Connect(function(enter)
    if enter then
        local num = tonumber(DelayBox.Text:match("%d+"))
        if num and num >= 1 and num <= 30 then
            customDelay = num
            DelayBox.Text = "Delay: "..num.."s"
        else
            DelayBox.Text = "Delay: "..customDelay.."s (1-30)"
        end
    end
end)

-- Update Money & Profit
spawn(function()
    while task.wait(1) do
        MoneyLabel.Text = "Money: "..string.format("%,d", getMoney()).."$"
        ProfitLabel.Text = "Profit/min: "..string.format("%,d", profitPerMinute).."$"
    end
end)

-- Buttons
local y = 235
local function btn(text, col, func)
    local b = Instance.new("TextButton")
    b.Size = UDim2.new(0,360,0,45)
    b.Position = UDim2.new(0.5,-180,0,y)
    b.BackgroundColor3 = col
    b.Text = text
    b.TextColor3 = Color3.new(1,1,1)
    b.TextSize = 20
    b.Font = Enum.Font.GothamBold
    b.Parent = Main
    Instance.new("UICorner", b).CornerRadius = UDim.new(0,10)
    b.MouseButton1Click:Connect(func)
    y = y + 52
end

btn("START AUTOFARM", Color3.fromRGB(0,200,0), startAutoFarm)
btn("STOP AUTOFARM", Color3.fromRGB(200,0,0), stopAutoFarm)
btn("TOGGLE FLY", Color3.fromRGB(0,140,255), function() flying = not flying; if flying then startFly() end end)
btn("TOGGLE NOCLIP", Color3.fromRGB(255,165,0), function() noclip = not noclip end)
btn("TOGGLE ESP", Color3.fromRGB(200,0,255), function() espEnabled = not espEnabled end)
btn("MIYOSHI NAME", Color3.fromRGB(255,80,80), setMiyoshiName)

-- WalkSpeed
local SpeedBox = Instance.new("TextBox")
SpeedBox.Size = UDim2.new(0,360,0,45)
SpeedBox.Position = UDim2.new(0.5,-180,0,y)
SpeedBox.BackgroundColor3 = Color3.fromRGB(60,0,60)
SpeedBox.Text = "WalkSpeed: 16"
SpeedBox.TextColor3 = Color3.new(1,1,1)
SpeedBox.Parent = Main
Instance.new("UICorner", SpeedBox).CornerRadius = UDim.new(0,10)
SpeedBox.FocusLost:Connect(function(e)
    if e then local n = tonumber(SpeedBox.Text:match("%d+")) if n and n>=16 and n<=500 then character.Humanoid.WalkSpeed = n SpeedBox.Text="WalkSpeed: "..n end end
end)

-- Hide X
local HideX = Instance.new("TextButton")
HideX.Size = UDim2.new(0,40,0,40)
HideX.Position = UDim2.new(1,-48,0,8)
HideX.BackgroundColor3 = Color3.fromRGB(255,50,50)
HideX.Text = "X"
HideX.Parent = Main
Instance.new("UICorner", HideX).CornerRadius = UDim.new(1,0)
HideX.MouseButton1Click:Connect(function() Main.Visible = false OpenBtn.Visible = true end)
OpenBtn.MouseButton1Click:Connect(function() Main.Visible = true OpenBtn.Visible = false end)

-- Draggable
local dragging = false
local dragStart, startPos
Main.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true dragStart = i.Position startPos = Main.Position
    end
end)
UserInputService.InputChanged:Connect(function(i)
    if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
        local d = i.Position - dragStart
        Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + d.X, startPos.Y.Scale, startPos.Y.Offset + d.Y)
    end
end)
Main.InputEnded:Connect(function() dragging = false end)

-- Noclip loop
RunService.Stepped:Connect(function()
    if noclip and character then
        for _, v in character:GetDescendants() do
            if v:IsA("BasePart") then v.CanCollide = false end
        end
    end
end)

-- Jalankan nama
task.wait(3)
setMiyoshiName()

print("MIYOSHI BLACK PREMIUM LOADED - Profit/min + Delay Setter + Gold Premium Tag")
